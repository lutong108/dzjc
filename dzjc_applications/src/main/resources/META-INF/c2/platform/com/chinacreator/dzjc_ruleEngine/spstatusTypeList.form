<?xml version="1.0" encoding="UTF-8"?>
<form:Form xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dync="http://www.chinacreator.com/platform/mvc/ui/dync" xmlns:form="http://www.chinacreator.com/platform/mvc/form" name="定时任务执行列表" sn="dzjc_ruleEngine/selectListByType" type="form">
  <form:control type="page/modal">
    <form:attributes source="page/modal">
      <dync:attribute default="" group="HTML" id="width" name="页面宽度" value="1200px">
        <dync:render colSpan="2" height="0" multi="false" name="text"/>
        <dync:children/>
      </dync:attribute>
      <dync:attribute default="" group="HTML" id="title" name="标题" value="定时任务执行列表">
        <dync:render colSpan="2" height="0" multi="false" name="text"/>
        <dync:children/>
      </dync:attribute>
    </form:attributes>
  </form:control>
  <form:child xsi:type="form:Group" id="div" name="简单容器(DIV)">
    <form:control type="container/div">
      <form:attributes source="container/div"/>
    </form:control>
    <form:child xsi:type="form:Field" id="button" name="查询异常" customize="true">
      <form:control type="widget/button">
        <form:attributes source="widget/button">
          <dync:attribute default="" group="事件设置" id="click" name="点击事件" value="button_click($event)">
            <dync:render colSpan="1" height="0" multi="false" name="event">
              <dync:item name="params" value="$event"/>
            </dync:render>
            <dync:children/>
          </dync:attribute>
        </form:attributes>
      </form:control>
      <form:validation/>
    </form:child>
    <form:child xsi:type="form:Field" id="button1" name="查询全部" customize="true">
      <form:control type="widget/button">
        <form:attributes source="widget/button">
          <dync:attribute default="" group="事件设置" id="click" name="点击事件" value="button1_click($event)">
            <dync:render colSpan="1" height="0" multi="false" name="event">
              <dync:item name="params" value="$event"/>
            </dync:render>
            <dync:children/>
          </dync:attribute>
        </form:attributes>
      </form:control>
      <form:validation/>
    </form:child>
  </form:child>
  <form:child xsi:type="form:Group" binding="$model.list" id="list" name="表格">
    <form:control type="container/table_jqgrid">
      <form:attributes source="container/table_jqgrid">
        <dync:attribute default="" group="表格设置" id="paramData" name="初始化参数" value="{&quot;batchId&quot;:$params.batchId,&quot;type&quot;:$params.type}">
          <dync:render colSpan="1" height="0" multi="false" name="text"/>
          <dync:children/>
        </dync:attribute>
      </form:attributes>
    </form:control>
    <form:child xsi:type="form:Group" id="toolbar_table" name="toolbar_table">
      <form:control type="container/toolbar_table">
        <form:attributes source="container/toolbar_table"/>
      </form:control>
    </form:child>
    <form:child xsi:type="form:Field" binding="id" id="id" name="id" customize="true">
      <form:control type="widget/col_jqgrid">
        <form:attributes source="widget/col_jqgrid">
          <dync:attribute default="false" group="表格设置" id="hidden" name="隐藏列" value="true">
            <dync:render colSpan="1" height="0" multi="false" name="checkbox"/>
            <dync:children/>
          </dync:attribute>
          <dync:attribute default="false" group="表格设置" id="key" name="主键列" value="true">
            <dync:render colSpan="1" height="0" multi="false" name="checkbox"/>
            <dync:children/>
          </dync:attribute>
        </form:attributes>
      </form:control>
      <form:validation/>
    </form:child>
    <form:child xsi:type="form:Field" binding="functionName" id="functionName" name="任务名称" customize="true">
      <form:control type="widget/col_jqgrid">
        <form:attributes source="widget/col_jqgrid"/>
      </form:control>
      <form:validation/>
    </form:child>
    <form:child xsi:type="form:Field" binding="superviseStartTime" id="superviseStartTime" name="开始时间" customize="true">
      <form:control type="widget/col_jqgrid">
        <form:attributes source="widget/col_jqgrid">
          <dync:attribute default="" group="格式设置" id="formatter" name="预定格式" value="millisecondDate">
            <dync:render colSpan="1" height="0" multi="false" name="select">
              <dync:item name="空" value=""/>
              <dync:item name="整数" value="integer"/>
              <dync:item name="数字" value="number"/>
              <dync:item name="货币" value="currency"/>
              <dync:item name="毫秒日期" value="millisecondDate"/>
              <dync:item name="邮件" value="email"/>
              <dync:item name="链接" value="link"/>
              <dync:item name="带参链接" value="showlink"/>
              <dync:item name="勾选框" value="checkbox"/>
              <dync:item name="选择" value="select"/>
              <dync:item name="事件" value="actions"/>
              <dync:item name="数据字典" value="dictionary"/>
            </dync:render>
            <dync:children/>
          </dync:attribute>
          <dync:attribute default="" group="格式设置" id="formatoptions" name="预定格式设置" value="{dateFormat:&quot;yyyy-MM-dd HH:mm:ss&quot;}">
            <dync:render colSpan="1" height="0" multi="false" name="text"/>
            <dync:children/>
          </dync:attribute>
        </form:attributes>
      </form:control>
      <form:validation/>
    </form:child>
    <form:child xsi:type="form:Field" binding="superviseEndTime" id="superviseEndTime" name="结束时间" customize="true">
      <form:control type="widget/col_jqgrid">
        <form:attributes source="widget/col_jqgrid">
          <dync:attribute default="" group="格式设置" id="formatter" name="预定格式" value="millisecondDate">
            <dync:render colSpan="1" height="0" multi="false" name="select">
              <dync:item name="空" value=""/>
              <dync:item name="整数" value="integer"/>
              <dync:item name="数字" value="number"/>
              <dync:item name="货币" value="currency"/>
              <dync:item name="毫秒日期" value="millisecondDate"/>
              <dync:item name="邮件" value="email"/>
              <dync:item name="链接" value="link"/>
              <dync:item name="带参链接" value="showlink"/>
              <dync:item name="勾选框" value="checkbox"/>
              <dync:item name="选择" value="select"/>
              <dync:item name="事件" value="actions"/>
              <dync:item name="数据字典" value="dictionary"/>
            </dync:render>
            <dync:children/>
          </dync:attribute>
          <dync:attribute default="" group="格式设置" id="formatoptions" name="预定格式设置" value="{dateFormat:&quot;yyyy-MM-dd HH:mm:ss&quot;}">
            <dync:render colSpan="1" height="0" multi="false" name="text"/>
            <dync:children/>
          </dync:attribute>
        </form:attributes>
      </form:control>
      <form:validation/>
    </form:child>
    <form:child xsi:type="form:Field" binding="superviseUseTimes" id="superviseUseTimes" name="时长" customize="true">
      <form:control type="widget/col_jqgrid">
        <form:attributes source="widget/col_jqgrid">
          <dync:attribute default="" group="格式设置" id="customFormatter" name="自定义格式" value="superviseUseTimes_customFormatter(cellvalue,options,rowObject,dictValueExpression)">
            <dync:render colSpan="2" height="0" multi="false" name="event">
              <dync:item name="param" value="cellvalue,options,rowObject,dictValueExpression"/>
            </dync:render>
            <dync:children/>
          </dync:attribute>
        </form:attributes>
      </form:control>
      <form:validation/>
    </form:child>
    <form:child xsi:type="form:Field" binding="processQty" id="processQty" name="处理数" customize="true">
      <form:control type="widget/col_jqgrid">
        <form:attributes source="widget/col_jqgrid"/>
      </form:control>
      <form:validation/>
    </form:child>
    <form:child xsi:type="form:Field" binding="status" id="status" name="结果" customize="true">
      <form:control type="widget/col_jqgrid">
        <form:attributes source="widget/col_jqgrid">
          <dync:attribute default="" group="格式设置" id="customFormatter" name="自定义格式" value="status_customFormatter(cellvalue,options,rowObject,dictValueExpression)">
            <dync:render colSpan="2" height="0" multi="false" name="event">
              <dync:item name="param" value="cellvalue,options,rowObject,dictValueExpression"/>
            </dync:render>
            <dync:children/>
          </dync:attribute>
        </form:attributes>
      </form:control>
      <form:validation/>
    </form:child>
    <form:child xsi:type="form:Field" binding="exception" id="exception" name="异常" customize="true">
      <form:control type="widget/col_jqgrid">
        <form:attributes source="widget/col_jqgrid"/>
      </form:control>
      <form:validation/>
    </form:child>
  </form:child>
  <form:datasources>
    <form:datasource xsi:type="form:Inputs"/>
    <form:datasource xsi:type="form:PagingDataSource" id="list" name="列表型数据源" base="service" pageSize="10" type="url" url="dzjc_ruleEngine/v1/spstatus/selectListByType"/>
  </form:datasources>
  <form:scripts>

superviseUseTimes_customFormatter:function(cellvalue,options,rowObject,dictValueExpression){
	if(!angular.isUndefined(cellvalue)){
		cellvalue = formatSecond(cellvalue);
	}
	return cellvalue;
},

status_customFormatter:function(cellvalue,options,rowObject,dictValueExpression){
	if(!angular.isUndefined(cellvalue)){
		if(cellvalue == 'Y'){
			cellvalue = '成功';
		}
		else {
			cellvalue = '失败';
		}
	}
	return cellvalue;
},
//装配参数
getParameters:function(){
	var queryParams = new Array();
	if(IsNotSpace($params.batchId)){
		queryParams.push({field:&quot;batchId&quot;,op:&quot;eq&quot;,data:$params.batchId}) ;
	}
	if(IsNotSpace($params.type)){
		queryParams.push({field:&quot;type&quot;,op:&quot;eq&quot;,data:$params.type}) ;
	}
	return queryParams;
},
//查询全部
button1_click:function($event){
	$view.mainForm.clean();
	var queryParams =functions.getParameters();
	var filters={groupOp:&quot;AND&quot;,rules:queryParams}
	$view.list.refresh({filters:filters});
},
//查询异常
button_click:function($event){
	var queryParams =functions.getParameters();
	queryParams.push({field:&quot;status&quot;,op:&quot;eq&quot;,data:&quot;N&quot;}) ;
	var filters={groupOp:&quot;AND&quot;,rules:queryParams}
	$view.list.refresh({filters:filters});
}</form:scripts>
</form:Form>
